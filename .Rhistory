p<-NULL
t1<-NULL
mu<-25
sig<-3
reps<-2000
samp<-50
set.seed(100)
sigs <- seq(10,0.1,-.1)
for (n in 1:length(sigs)) { # iterate through a range of sigma
for (r in 1:reps) { # do the experiment "reps" times for each sample size
pop1<-rnorm(samp,mu,sigs[n]) # take 50 samples from "pop1"
pop2<-rnorm(samp,mu,sigs[n]) # take 50 samples from "pop2", the exact same distribution
p[r]<-t.test(pop1,pop2)$p.value # do the t-test and harvest the p-values
}
t1[n]<-mean(p<0.05) # harvest the type I error rate for experiments of size n
} # note the indexing trick above - why did we start with n=2? - To have an average of two, not a sample of 1, can't run a t-test on a sample of 1.
# now plot the distribution of type 1 error
plot(sigs,t1,xlab="standard deviation (sigma)",ylab="type I error rate")
# add line to indicate the expected rate (0.05)
abline(h=0.05,col="red")
mice<-read.csv("P:/My Documents/BDA_Spring2018/femaleMiceWeights.csv") # point this to your file
# see what variables are in the dataframe
names(mice)
# Diet is the treatment (explanatory variable) and Bodyweight is the response variable
t.test(mice$Bodyweight~mice$Diet)
# above code is shorthand for separating subsets of data by a factor variable
# in English: "variation in Bodyweight can be explained by variation in Diet"
# take the time to understand all of the output
# especially the effect size and associated confidence interval...
26.83417-23.81333
mice$Bodyweight[mice$Diet=="hf"]))
diffmeans <- (mean(mice$Bodyweight[mice$Diet=="hf"])-
mean(mice$Bodyweight[mice$Diet=="chow"]))/ #3.02
mean(mice$Bodyweight[mice$Diet=="chow"])*100            #23.81
diffmeans
t.test(Bodyweight~Diet, data=mice)$conf.int/mean(mice$Bodyweight[mice$Diet=="chow"])
library(ggplot2)
ggplot(mice, aes(Diet,Bodyweight))+
geom_boxplot()+
geom_point( position = position_jitter(w = 0.1, h = 0))+
theme_bw()
